<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>A.P</title>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" type="text/css" href="/assets/css/fontawesome-all.min.css">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon.ico">

  <!-- Google Analytics -->
  

</head>


  <body>
    <nav class="nav">
      <div class="nav-container">
        <a href="/">
          <h2 class="nav-title">A.P</h2>
        </a>
        <ul>
          <li><a href="/">About</a></li>
          <li><a href="/portfolio/">Portfolio</a></li>
        </ul>
    </div>
  </nav>

    <main>
      <div class="post">
  <h2 class="post-title">CozyHouse</h2>
  <div class="post-line"></div>

  <h1 id="-cozyhouse">📌 CozyHouse</h1>
<p>“cinema”와 “broadcast”의 결합으로 영화를 브로드캐스팅하여 사용자에게 최신 영화 정보와 편리한 예매 서비스를 제공합니다.</p>

<h2 id="️-프로젝트-소개">🖥️ 프로젝트 소개</h2>
<p>스프링 부트를 이용해 오늘의 집 사이트를 참고하여 만든 쇼핑몰입니다.</p>

<h2 id="-프로젝트-구성원">👨‍👩‍👦 프로젝트 구성원</h2>
<ul>
  <li><strong>팀장</strong>: 김민석 - 프론트엔드</li>
  <li><strong>팀원1</strong>: 이병훈 - 백엔드</li>
  <li><strong>팀원2</strong>: 김준모 - 백엔드</li>
</ul>

<h2 id="️-사용된-기술">⚙️ 사용된 기술</h2>
<p>JAVA, MYSQL, JPA, Spring Framework, CSS3, HTML5, BOOTSTRAP, JAVASCRIPT, JQUERY</p>

<h1 id="-수행업무">💡 수행업무</h1>

<h2 id="회원가입">회원가입</h2>
<ul>
  <li>OAuth2 방식을 사용하여 JWT를 이용한 회원가입 기능을 구현하였습니다.</li>
  <li>모든 회원가입 로직은 백엔드에서 처리합니다.</li>
</ul>

<h2 id="로그인-소셜로그인-로그아웃">로그인, 소셜로그인, 로그아웃</h2>
<ul>
  <li>OAuth2 방식으로 로그인 및 소셜 로그인 기능을 구현하였습니다.</li>
  <li>JWT를 사용하여 인증 토큰을 관리하고, 모든 인증 관련 로직은 백엔드에서 처리합니다.</li>
  <li>여러 필터를 커스터마이즈하여 로그인, 로그아웃 및 JWT 검증을 관리합니다.</li>
  <li>리프레시 토큰을 사용하여 세션 유지 기능을 구현하였으며, 리프레시 토큰 로테이션을 통해 보안성을 강화하였습니다.</li>
</ul>

<h2 id="전역예외처리">전역예외처리</h2>
<ul>
  <li>AOP를 활용해 애플리케이션 전반에 걸쳐 발생하는 예외를 처리합니다.</li>
</ul>

<h2 id="글쓰기">글쓰기</h2>
<ul>
  <li>파일 업로드를 위해 MultiparFile와 Java NIO를 사용하여 처리합니다.</li>
</ul>

<h1 id="️-트러블슈팅-내용">🛠️ 트러블슈팅 내용</h1>
<h2 id="문제-상황">문제 상황</h2>
<ul>
  <li>소셜 로그인 구현 시, 일반 로그인처럼 엑세스 토큰과 리프레시 토큰을 HTTP 응답 헤더로 받으려 했으나, 하이퍼링크를 통해 리다이렉션되는 과정에서 응답 헤더에 직접 접근할 수 없는 상황이 발생했습니다. 이로 인해 JWTFilter는 요청 헤더에서 받은 엑세스 쿠키로 인증을 하게 되는데, 이로 인해 일관성이 떨어지는 문제가 발생했습니다.</li>
</ul>

<h2 id="해결-방안">해결 방안</h2>
<ol>
  <li><strong>쿠키를 통한 토큰 전송</strong>
    <ul>
      <li>소셜 로그인 후, 엑세스 토큰과 리프레시 토큰을 서버에서 쿠키로 설정해 클라이언트에 전송.</li>
      <li>HttpOnly 속성을 사용하여 JavaScript에서 쿠키에 접근할 수 없도록 설정해 XSS 공격에 대한 보안을 강화.</li>
    </ul>
  </li>
  <li><strong>엑세스 토큰 요청 헤더로 변환</strong>
    <ul>
      <li>로그인 성공 핸들러를 통해 JWT를 발급하는 방식이 쿠키와 헤더로 다르기 때문에, 쿠키에 저장된 엑세스 토큰을 클라이언트에서 요청 헤더로 변환하여 백엔드에 요청.</li>
      <li>서버에서 새로운 엑세스 토큰을 응답 헤더로 받아올 수 있도록 하여 JWTFilter의 일관성을 유지하고, 모든 인증 로직을 요청 헤더 방식으로 통합.</li>
    </ul>
  </li>
  <li><strong>로컬 스토리지에 저장</strong>
    <ul>
      <li>서버에서 받은 엑세스 토큰은 로컬 스토리지에 저장해 클라이언트에서 쉽게 접근할 수 있도록 설정.</li>
      <li>로컬 스토리지에 저장된 토큰이 XSS 공격에 노출되지 않도록 콘텐츠 보안 정책(CSP, Content Security Policy)을 설정.</li>
    </ul>
  </li>
</ol>

<h2 id="결론">결론</h2>
<ul>
  <li>결국 소셜 로그인에서는 하이퍼링크로 인한 리다이렉션 문제로 인해 쿠키를 통해 토큰을 전송하는 방식을 선택할 수밖에 없었습니다. 이 과정에서 엑세스 토큰을 요청 헤더로 변환해 클라이언트에 전송함으로써 일관성을 유지하게 되었습니다. 로그인 성공 핸들러에서 발급 방식을 통합함으로써 JWTFilter의 일관성을 확보했고, 이런 접근은 보안과 사용성을 동시에 고려한 해결책으로 프로젝트에서 효과적으로 적용할 수 있었습니다.</li>
</ul>

<h2 id="느낀-점">느낀 점</h2>
<ul>
  <li>이번 JWT토큰을 사용함으로써 쿠키와 요청 헤더를 조합하여 인증 로직을 통합하는 방식이 효과적이라는 것을 실감했습니다. 특히, HttpOnly 속성의 중요성을 알게 되어 XSS 공격에 대한 방어를 강화하는 방법을 배웠습니다. 또한, 로컬 스토리지와 CSP(Content Security Policy)를 활용하여 클라이언트 측 보안을 높일 수 있다는 점도 인상 깊었습니다. 이러한 경험을 통해 웹 보안의 중요성을 이해하게 되었고, 앞으로 JWT를 활용하여 보다 안전하고 효율적인 시스템을 구축하는 데 기여하고 싶습니다.</li>
</ul>


</div>

<div class="pagination">
  
  
    <a href="/2024-03-25/create-ap.theme" class="right next">Next</a>
  

  <a href="#" class="top">Top</a>
</div>

    </main>

    <footer>
      <span>
        &copy; <time datetime="2024-09-15 05:23:26 +0900">2024</time> byeongHoon Lee. <a href="https://github.com/kssim/about-portfolio/">A.P</a> theme by kssim.
      </span>
    </footer>
  </body>
</html>
